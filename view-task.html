<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>View Task</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://kit.fontawesome.com/a2e0c6cf13.js" crossorigin="anonymous"></script>
  <style>
   html, body {
      height: 100%;
      margin: 0;
      overflow: hidden; /* hides scrollbars */
    }

    body {
      background-image: url('images/bg.png');
      background-repeat: no-repeat;
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      height: 100vh;
    }
    .view-container {
      max-width: 600px;
      margin: 80px auto;
      padding: 30px;
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.1);
    }
    .btn-back {
      background-color: #6c757d;
      color: white;
    }
    .badge-high { background-color: #dc3545; }
    .badge-medium { background-color: #ffc107; color: #212529; }
    .badge-low { background-color: #198754; }
  </style>
</head>
<body>

<div class="view-container">
  <h3 class="text-primary mb-4"><i class="fas fa-tasks me-2"></i>Task Details</h3>
  <p><strong>Name:</strong> <span id="taskName">Loading...</span></p>
  <p><strong>Description:</strong><br /><span id="taskDescription" class="text-dark">Loading...</span></p>
  <p><strong>Priority Level:</strong> <span id="taskPriority" class="badge">--</span></p>
  <p><strong>Due Date:</strong> <span id="taskDueDate">--</span></p>


  <a href="index.html" class="btn btn-back mt-4"><i class="fas fa-arrow-left me-1"></i> Back to Task List</a>
</div>

<script>
  // Attempt to parse stored JSON object
  let taskData = null;
  try {
    taskData = JSON.parse(localStorage.getItem('selectedTask'));
  } catch (e) {
    // It might already be a string
    taskData = localStorage.getItem('selectedTask');
  }

  // If it's a string, wrap it as a name only
  if (typeof taskData === 'string') {
    taskData = { name: taskData, description: '', priority: 'N/A' };
  }

  const nameEl = document.getElementById('taskName');
  const descEl = document.getElementById('taskDescription');
  const priEl = document.getElementById('taskPriority');
  const dueDateEl = document.getElementById('taskDueDate');

if (taskData && taskData.name) {
  // existing code
  nameEl.textContent = taskData.name;
  descEl.textContent = taskData.description || '--';
  
  const level = taskData.priority || 'N/A';
  priEl.textContent = level;
  priEl.className = 'badge ' + (
    level === 'High' ? 'badge-high' :
    level === 'Medium' ? 'badge-medium' :
    level === 'Low' ? 'badge-low' :
    'bg-secondary'
  );

  // New: Display due date
  if (taskData.dueDate) {
    // Format date nicely, e.g. "July 21, 2025"
    const dateObj = new Date(taskData.dueDate);
    if (!isNaN(dateObj)) {
      dueDateEl.textContent = dateObj.toLocaleDateString(undefined, { year: 'numeric', month: 'long', day: 'numeric' });
    } else {
      dueDateEl.textContent = taskData.dueDate; // fallback to raw string
    }
  } else {
    dueDateEl.textContent = '--';
  }
} else {
  // fallback when no task selected
  nameEl.textContent = 'No task selected.';
  descEl.textContent = '--';
  priEl.textContent = '--';
  priEl.className = 'badge bg-secondary';
  dueDateEl.textContent = '--';
}

</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
